{"componentChunkName":"component---src-templates-post-jsx","path":"/securityBasicNotes/","result":{"pageContext":{"post":{"slug":"/securityBasicNotes/","title":"Security Basic Notes","subtitle":"Be a Stupid Learner","author":"Sabertaz","tags":["Computer Science","Web Development","Security"],"date":"2017-10-05T00:00:00.000Z","timeToRead":13,"excerpt":"Security Basic Notes Curated List of Vulnerability(漏洞) Object Injection    Insecure Object Comparison injection: solutions:   SQL Injection user input: ’ or 1=1– SQL Injection Protection parameterized statements Click Jacking Hover a transparent malicious link upon the true button Click Jacking Protection frame killing snippet X-Frame-Options Session Fixation Protection 在 HTTP Cookies 中传输复杂的 Session IDs, 并在成功连接/恶意篡改后重置 Session IDs. where: not passing session IDs in queryStrings/requestBody…","toc":"<ul>\n<li>\n<p><a href=\"#security-basic-notes\">Security Basic Notes</a></p>\n<ul>\n<li>\n<p><a href=\"#curated-list-of-vulnerability%E6%BC%8F%E6%B4%9E\">Curated List of Vulnerability(漏洞)</a></p>\n<ul>\n<li>\n<p><a href=\"#object-injection\">Object Injection</a></p>\n<ul>\n<li><a href=\"#insecure-object-comparison\">Insecure Object Comparison</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#sql-injection\">SQL Injection</a></p>\n<ul>\n<li><a href=\"#sql-injection-protection\">SQL Injection Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#click-jacking\">Click Jacking</a></p>\n<ul>\n<li><a href=\"#click-jacking-protection\">Click Jacking Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#session-fixation\">Session Fixation</a></p>\n<ul>\n<li><a href=\"#protection\">Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#xsscross-site-scripting-attack\">XSS(Cross-Site-Scripting) Attack</a></p>\n<ul>\n<li><a href=\"#xss-protection\">XSS Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#csrfcross-site-request-forgery---%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0\">CSRF(Cross-Site Request Forgery) - 跨站请求伪造</a></p>\n<ul>\n<li><a href=\"#csrf-protection\">CSRF Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#file-upload-vulnerabilities\">File Upload Vulnerabilities</a></p>\n<ul>\n<li><a href=\"#file-upload-protection\">File Upload Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#malicious-redirects\">Malicious Redirects</a></p>\n<ul>\n<li><a href=\"#malicious-redirects-protection\">Malicious Redirects Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#user-enumeration\">User Enumeration</a></p>\n<ul>\n<li><a href=\"#user-enumeration-protection\">User Enumeration Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#inline-document-type-definition-in-xml\">Inline Document Type Definition in XML</a></p>\n<ul>\n<li><a href=\"#xml-protection\">XML Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#information-leakage\">Information Leakage</a></p>\n<ul>\n<li><a href=\"#information-leakage-protection\">Information Leakage Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#secure-treatment-of-passwords\">Secure Treatment of Passwords</a></p>\n</li>\n<li>\n<p><a href=\"#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%94%BB%E5%87%BB\">目录遍历攻击</a></p>\n<ul>\n<li><a href=\"#directory-protection\">Directory Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E7%97%85%E6%AF%92-npm-%E5%8C%85\">病毒 NPM 包</a></p>\n<ul>\n<li><a href=\"#package-protection\">Package Protection</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-dos-%E6%94%BB%E5%87%BB-redos\">正则表达式 DoS 攻击 (ReDoS)</a></p>\n<ul>\n<li><a href=\"#redos-protection\">ReDoS Protection</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#jwt\">JWT</a></p>\n</li>\n<li>\n<p><a href=\"#security-checklist\">Security Checklist</a></p>\n<ul>\n<li><a href=\"#%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F-%E6%B3%A8%E5%86%8C%E6%B3%A8%E5%86%8C%E4%BA%8C%E6%AC%A1%E9%AA%8C%E8%AF%81%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE\">权限系统 (注册/注册/二次验证/密码重置)</a></li>\n<li><a href=\"#%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%92%8C%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C\">用户数据和权限校验</a></li>\n<li><a href=\"#%E5%AE%89%E5%8D%93%E5%92%8C-ios-app\">安卓和 iOS APP</a></li>\n<li><a href=\"#%E5%AE%89%E5%85%A8%E5%A4%B4%E4%BF%A1%E6%81%AF%E5%92%8C%E9%85%8D%E7%BD%AE\">安全头信息和配置</a></li>\n<li><a href=\"#%E8%BF%87%E6%BB%A4%E8%BE%93%E5%85%A5\">过滤输入</a></li>\n<li><a href=\"#%E6%93%8D%E4%BD%9C\">操作</a></li>\n<li><a href=\"#%E5%85%B3%E4%BA%8E%E4%BA%BA\">关于人</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","html":"<h1 id=\"security-basic-notes\" style=\"position:relative;\"><a href=\"#security-basic-notes\" aria-label=\"security basic notes permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Security Basic Notes</h1>\n<h2 id=\"curated-list-of-vulnerability漏洞\" style=\"position:relative;\"><a href=\"#curated-list-of-vulnerability%E6%BC%8F%E6%B4%9E\" aria-label=\"curated list of vulnerability漏洞 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Curated List of Vulnerability(漏洞)</h2>\n<h3 id=\"object-injection\" style=\"position:relative;\"><a href=\"#object-injection\" aria-label=\"object injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Object Injection</h3>\n<ul>\n<li><code class=\"language language-text\">__proto__.XX</code></li>\n<li><code class=\"language language-text\">constructor</code></li>\n<li><code class=\"language language-text\">hasOwnProperty</code></li>\n</ul>\n<h4 id=\"insecure-object-comparison\" style=\"position:relative;\"><a href=\"#insecure-object-comparison\" aria-label=\"insecure object comparison permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Insecure Object Comparison</h4>\n<p>injection:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token keyword\">const</span> token <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>cookies<span class=\"token punctuation\">.</span>token<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// vulnerability:</span>\n<span class=\"token comment\">// SESSIONS[constructor] => `true`</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>token <span class=\"token operator\">&amp;&amp;</span> <span class=\"token constant\">SESSIONS</span><span class=\"token punctuation\">[</span>token<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>solutions:</p>\n<ul>\n<li><code class=\"language language-text\">crypto.timiingSafeEqual</code></li>\n<li><code class=\"language language-text\">object.hasOwnProperty(token)</code></li>\n</ul>\n<h3 id=\"sql-injection\" style=\"position:relative;\"><a href=\"#sql-injection\" aria-label=\"sql injection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQL Injection</h3>\n<p>user input: ’ or 1=1–</p>\n<div class=\"gatsby-highlight\" data-language=\"sql\"><pre class=\"language language-sql\"><code class=\"language language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span>\n  <span class=\"token keyword\">FROM</span> users\n <span class=\"token keyword\">WHERE</span> email <span class=\"token operator\">=</span> <span class=\"token string\">'user@email.com'</span>\n   <span class=\"token operator\">AND</span> pass  <span class=\"token operator\">=</span> <span class=\"token string\">''</span> <span class=\"token operator\">or</span> <span class=\"token number\">1</span><span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token comment\">--' LIMIT 1</span></code></pre></div>\n<h4 id=\"sql-injection-protection\" style=\"position:relative;\"><a href=\"#sql-injection-protection\" aria-label=\"sql injection protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SQL Injection Protection</h4>\n<p>parameterized statements</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token comment\">// Construct the SQL statement we want to run, specifying the parameter.</span>\nString sql <span class=\"token operator\">=</span> <span class=\"token string\">\"SELECT * FROM users WHERE email = ?\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"click-jacking\" style=\"position:relative;\"><a href=\"#click-jacking\" aria-label=\"click jacking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Click Jacking</h3>\n<p>Hover a transparent malicious link upon the true button</p>\n<h4 id=\"click-jacking-protection\" style=\"position:relative;\"><a href=\"#click-jacking-protection\" aria-label=\"click jacking protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Click Jacking Protection</h4>\n<ul>\n<li>frame killing snippet</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language language-html\"><code class=\"language language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\n  <span class=\"token comment\">/* Hide page by default */</span>\n  <span class=\"token selector\">html</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>self <span class=\"token operator\">==</span> top<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Everything checks out, show the page.</span>\n    document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Break out of the frame.</span>\n    top<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li>X-Frame-Options</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token comment\">// nodejs</span>\nresponse<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">'X-Frame-Options'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'DENY'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nresponse<span class=\"token punctuation\">.</span><span class=\"token function\">setHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-Security-Policy'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"frame-ancestors 'none'\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"session-fixation\" style=\"position:relative;\"><a href=\"#session-fixation\" aria-label=\"session fixation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Session Fixation</h3>\n<h4 id=\"protection\" style=\"position:relative;\"><a href=\"#protection\" aria-label=\"protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Protection</h4>\n<p>在 <strong>HTTP Cookies</strong> 中传输<strong>复杂</strong>的 Session IDs, 并在<strong>成功连接</strong>/<strong>恶意篡改</strong>后重置 Session IDs.</p>\n<ul>\n<li>where: not passing session IDs in queryStrings/requestBody,\ninstead of passing them in <strong>HTTP cookies</strong></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\">req<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span><span class=\"token function\">regenerate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// New session here</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>what: generate complex session IDs</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateSessionId</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">sess</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">uid</span><span class=\"token punctuation\">(</span><span class=\"token number\">24</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>how: reset session IDs after set up session successfully</li>\n<li>how: reset session IDs after it’s been changed manually on client(Set-Cookies)</li>\n</ul>\n<h3 id=\"xsscross-site-scripting-attack\" style=\"position:relative;\"><a href=\"#xsscross-site-scripting-attack\" aria-label=\"xsscross site scripting attack permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XSS(Cross-Site-Scripting) Attack</h3>\n<ul>\n<li>Reflected XSS: url input(search pages)</li>\n</ul>\n<p>user input: <code class=\"language language-text\">&lt;script> malicious code &lt;/script></code></p>\n<h4 id=\"xss-protection\" style=\"position:relative;\"><a href=\"#xss-protection\" aria-label=\"xss protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XSS Protection</h4>\n<p>don’t trust user:</p>\n<ul>\n<li><code class=\"language language-text\">replace(/&lt;script>|&lt;script/>/g, '')</code></li>\n<li><code class=\"language language-text\">trim()</code></li>\n<li>using template engine(handlebars, jade, etc…)</li>\n</ul>\n<h3 id=\"csrfcross-site-request-forgery---跨站请求伪造\" style=\"position:relative;\"><a href=\"#csrfcross-site-request-forgery---%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0\" aria-label=\"csrfcross site request forgery   跨站请求伪造 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSRF(Cross-Site Request Forgery) - 跨站请求伪造</h3>\n<p>挟制用户在当前已登录的 Web 应用程序上执行非本意的操作,\n利用已认证用户(长期 Cookies), 访问攻击者网站, 并被强制执行脚本,\n在用户不知情的情况下提交 Get/Post Request with Cookies 给被攻击网站.</p>\n<p>XSS 利用的是网站对用户(输入)的信任,\nCSRF 利用的是网站对用户网页浏览器的信任.</p>\n<h4 id=\"csrf-protection\" style=\"position:relative;\"><a href=\"#csrf-protection\" aria-label=\"csrf protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CSRF Protection</h4>\n<ul>\n<li>GET request 没有副作用</li>\n<li>确保 request 正常渠道发起(hidden token check in form)</li>\n<li>开启同源策略(Same Origin Policy)</li>\n<li>Addition Authentication: input password again</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\">express<span class=\"token operator\">/</span>csurf library</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language language-html\"><code class=\"language language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span>\n  <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://an.evil.site<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">target</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>_blank<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>noopener noreferrer\nnofollow<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">></span></span>进入一个“邪恶”的网站<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span>\n<span class=\"token punctuation\">></span></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token comment\">// old browser</span>\n<span class=\"token string\">'use strict'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">openUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> newTab <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  newTab<span class=\"token punctuation\">.</span>opener <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  newTab<span class=\"token punctuation\">.</span>location <span class=\"token operator\">=</span> url<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"file-upload-vulnerabilities\" style=\"position:relative;\"><a href=\"#file-upload-vulnerabilities\" aria-label=\"file upload vulnerabilities permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File Upload Vulnerabilities</h3>\n<p>当使用 JS 代码限制上传文件类型时, 攻击者 Disable JS in Browser, 并上传 malicious code file.</p>\n<div class=\"gatsby-highlight\" data-language=\"php\"><pre class=\"language language-php\"><code class=\"language language-php\"><span class=\"token php language-php\"><span class=\"token delimiter important\">&lt;?php</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">isset</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token variable\">$cmd</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$_REQUEST</span><span class=\"token punctuation\">[</span><span class=\"token string single-quoted-string\">'cmd'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">system</span><span class=\"token punctuation\">(</span><span class=\"token variable\">$cmd</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">echo</span> <span class=\"token string single-quoted-string\">'What is your bidding?'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token delimiter important\">?></span></span></code></pre></div>\n<h4 id=\"file-upload-protection\" style=\"position:relative;\"><a href=\"#file-upload-protection\" aria-label=\"file upload protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>File Upload Protection</h4>\n<p>对于上传文件:</p>\n<ul>\n<li>隔离 + 禁止执行</li>\n<li>重命名/Hash 化: 以防攻击者找到此文件</li>\n<li>检查文件格式</li>\n<li>检查 Content-Type Header</li>\n<li>使用 Virus Scanner</li>\n</ul>\n<h3 id=\"malicious-redirects\" style=\"position:relative;\"><a href=\"#malicious-redirects\" aria-label=\"malicious redirects permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Malicious Redirects</h3>\n<h4 id=\"malicious-redirects-protection\" style=\"position:relative;\"><a href=\"#malicious-redirects-protection\" aria-label=\"malicious redirects protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Malicious Redirects Protection</h4>\n<p>Check the Referer when doing redirects</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language language-js\"><code class=\"language language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">isRelative</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">url</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> url <span class=\"token operator\">&amp;&amp;</span> url<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^\\/[^\\/\\\\]</span><span class=\"token regex-delimiter\">/</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3 id=\"user-enumeration\" style=\"position:relative;\"><a href=\"#user-enumeration\" aria-label=\"user enumeration permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>User Enumeration</h3>\n<p>通过暴力工具得到被攻击网站的用户名单, 并利用社工得到密码</p>\n<blockquote>\n<p>很显然, REST API 无法抵抗此种攻击\nE.g <a href=\"https://github.com\">GitHub User Profile</a></p>\n</blockquote>\n<h4 id=\"user-enumeration-protection\" style=\"position:relative;\"><a href=\"#user-enumeration-protection\" aria-label=\"user enumeration protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>User Enumeration Protection</h4>\n<h5 id=\"login\" style=\"position:relative;\"><a href=\"#login\" aria-label=\"login permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Login</h5>\n<p>使攻击者无法枚举用户名, 他无法确定是用户不存在还是密码错误</p>\n<ul>\n<li>Login error message: Unkonwn User <strong>or</strong> Password</li>\n<li>All login code-paths take the same time on average: time consuming operations</li>\n<li>All login code-paths take the same context: session IDs, cookies</li>\n</ul>\n<h5 id=\"signupresetnot-with-name-should-with-email\" style=\"position:relative;\"><a href=\"#signupresetnot-with-name-should-with-email\" aria-label=\"signupresetnot with name should with email permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Signup/Reset(not with name, should with email)</h5>\n<p>使攻击者无法枚举用户名, 他无法确定是用户不存在还是用户已存在</p>\n<ul>\n<li>Not Exist: Sending sign-up email</li>\n<li>Exist: Sending pwd-reset email</li>\n</ul>\n<h3 id=\"inline-document-type-definition-in-xml\" style=\"position:relative;\"><a href=\"#inline-document-type-definition-in-xml\" aria-label=\"inline document type definition in xml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Inline Document Type Definition in XML</h3>\n<p>Dangerous Macros:</p>\n<ul>\n<li>XML Bombs</li>\n<li>XML Externel Entities</li>\n</ul>\n<h4 id=\"xml-protection\" style=\"position:relative;\"><a href=\"#xml-protection\" aria-label=\"xml protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>XML Protection</h4>\n<p>Disable DTD parse in XML parser</p>\n<h3 id=\"information-leakage\" style=\"position:relative;\"><a href=\"#information-leakage\" aria-label=\"information leakage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Information Leakage</h3>\n<ul>\n<li>Server in Response Headers</li>\n<li>Cookies: JSESSIONID -> java</li>\n<li>URL: .jsp, .php, .asp</li>\n<li>Error Message</li>\n<li>AJAX responses</li>\n<li>JSON/XML reponses</li>\n<li>Code Information</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language language-json\"><code class=\"language language-json\"><span class=\"token punctuation\">{</span>\n    Server<span class=\"token operator\">:</span> Apache/<span class=\"token number\">1.3</span>.<span class=\"token number\">23</span>\n    Accept-Ranges<span class=\"token operator\">:</span>  bytes\n    Content-length<span class=\"token operator\">:</span> <span class=\"token number\">196</span>\n    Connection<span class=\"token operator\">:</span> close\n    Content-Type<span class=\"token operator\">:</span> text/html\n    Cookie<span class=\"token operator\">:</span> JSESSIONID=XXXXX\n<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">{</span>\n    Server<span class=\"token operator\">:</span> Microsoft-IIS/<span class=\"token number\">5.0</span>\n    Content-Type<span class=\"token operator\">:</span> text/html\n    Accept-Ranges<span class=\"token operator\">:</span> bytes\n    ETag<span class=\"token operator\">:</span> <span class=\"token string\">\"b0aac0542e25c31\"</span>\n    Content-Length<span class=\"token operator\">:</span> <span class=\"token number\">7369</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h4 id=\"information-leakage-protection\" style=\"position:relative;\"><a href=\"#information-leakage-protection\" aria-label=\"information leakage protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Information Leakage Protection</h4>\n<ul>\n<li><code class=\"language language-text\">NODE_ENV=production</code></li>\n<li>处理/混淆/加密原始数据(raw data)</li>\n<li>处理/混淆客户端代码</li>\n<li>去除工具库的版本信息</li>\n<li>Disable the “Server” HTTP Header and Similar Headers</li>\n<li>Use Clean URLs without extensions</li>\n<li>Ensure Cookie Parameters are Generic</li>\n<li>Disable Client-Side Error Reporting</li>\n<li>Sanitize Data Passed to the Client</li>\n<li>Obfuscate JavaScript\\</li>\n<li>Sanitize Template Files</li>\n<li>Ensure Correct Configuration of Web Root Directory</li>\n</ul>\n<h3 id=\"secure-treatment-of-passwords\" style=\"position:relative;\"><a href=\"#secure-treatment-of-passwords\" aria-label=\"secure treatment of passwords permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Secure Treatment of Passwords</h3>\n<blockquote>\n<p><a href=\"https://www.hacksplaining.com/prevention/password-mismanagement\">Hacks Explain</a></p>\n</blockquote>\n<h3 id=\"目录遍历攻击\" style=\"position:relative;\"><a href=\"#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%94%BB%E5%87%BB\" aria-label=\"目录遍历攻击 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>目录遍历攻击</h3>\n<p>GET /../../../passwd.key HTTP/1.1</p>\n<h4 id=\"directory-protection\" style=\"position:relative;\"><a href=\"#directory-protection\" aria-label=\"directory protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Directory Protection</h4>\n<p>检查请求路径是否安全, 否则不返回响应</p>\n<h3 id=\"病毒-npm-包\" style=\"position:relative;\"><a href=\"#%E7%97%85%E6%AF%92-npm-%E5%8C%85\" aria-label=\"病毒 npm 包 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>病毒 NPM 包</h3>\n<p>名字与流行包相近, 通过 postinstall 脚本执行病毒脚本，获取系统环境变量信息 e.g crossenv</p>\n<h4 id=\"package-protection\" style=\"position:relative;\"><a href=\"#package-protection\" aria-label=\"package protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Package Protection</h4>\n<ul>\n<li>No typo in package.json</li>\n<li>禁止执行 postinstall 脚本</li>\n</ul>\n<h3 id=\"正则表达式-dos-攻击-redos\" style=\"position:relative;\"><a href=\"#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F-dos-%E6%94%BB%E5%87%BB-redos\" aria-label=\"正则表达式 dos 攻击 redos permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>正则表达式 DoS 攻击 (ReDoS)</h3>\n<p>正则表达式引擎采用回溯的方式匹配所有可能性，导致性能问题</p>\n<h4 id=\"redos-protection\" style=\"position:relative;\"><a href=\"#redos-protection\" aria-label=\"redos protection permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ReDoS Protection</h4>\n<ul>\n<li>不使用 NFA 实现的正则表达式引擎, 使用 DFA 实现的正则表达式引擎</li>\n<li>不定义性能消耗过大的正则表达式</li>\n<li>不动态构造正则表达式 new RegExp()</li>\n<li>禁止用户输入影响正则表达式构建/匹配</li>\n</ul>\n<h2 id=\"jwt\" style=\"position:relative;\"><a href=\"#jwt\" aria-label=\"jwt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JWT</h2>\n<p>JSON Web Tokens is small, object-friendly\n(compared to SAML, Security Assertion Markup Language Tokens)\nand security for public/private key pair\n(compared to SWT, Simple Web Tokens)</p>\n<h2 id=\"security-checklist\" style=\"position:relative;\"><a href=\"#security-checklist\" aria-label=\"security checklist permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Security Checklist</h2>\n<p><a href=\"README-zh.md\">返回目录</a></p>\n<h3 id=\"权限系统-注册注册二次验证密码重置\" style=\"position:relative;\"><a href=\"#%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F-%E6%B3%A8%E5%86%8C%E6%B3%A8%E5%86%8C%E4%BA%8C%E6%AC%A1%E9%AA%8C%E8%AF%81%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE\" aria-label=\"权限系统 注册注册二次验证密码重置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>权限系统 (注册/注册/二次验证/密码重置)</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 任何地方都使用 HTTPS.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用 <code class=\"language language-text\">Bcrypt</code> 存储密码哈希 (没有使用盐的必要 - <code class=\"language language-text\">Bcrypt</code> 干的就是这个事).</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">登出</code>之后销毁会话 ID .</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 密码重置后销毁所有活跃的会话.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> OAuth2 验证必须包含 <code class=\"language language-text\">state</code> 参数.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 登陆成功之后不能直接重定向到开放的路径（需要校验，否则容易存在钓鱼攻击）.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 当解析用户注册/登陆的输入时，过滤 javascript://、 data:// 以及其他 CRLF 字符.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用 secure/httpOnly cookies.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 移动端使用 <code class=\"language language-text\">OTP</code> 验证时，当调用 <code class=\"language language-text\">generate OTP</code> 或者 <code class=\"language language-text\">Resend OTP</code> API 时不能把 OTP\n（One Time Password） 直接返回。（一般是通过发送手机验证短信，邮箱随机 code 等方式，而不是直接 response）</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 限制单个用户 <code class=\"language language-text\">Login</code>、<code class=\"language language-text\">Verify OTP</code>、 <code class=\"language language-text\">Resend OTP</code>、<code class=\"language language-text\">generate OTP</code> 等 API 的调用次数，\n使用 Captcha 等手段防止暴力破解.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 检查邮件或短信里的重置密码的 token，确保随机性（无法猜测）</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 给重置密码的 token 设置过期时间.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 重置密码成功后，将重置使用的 token 失效.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> Nodejs 等不使用 sudo 运行</li>\n</ul>\n<h3 id=\"用户数据和权限校验\" style=\"position:relative;\"><a href=\"#%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E5%92%8C%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C\" aria-label=\"用户数据和权限校验 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>用户数据和权限校验</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 诸如<code class=\"language language-text\">我的购物车</code>、<code class=\"language language-text\">我的浏览历史</code>之类的资源访问，必须检查当前登录的用户是否有这些资源的访问权限.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 避免资源 ID 被连续遍历访问，使用 <code class=\"language language-text\">/me/orders</code> 代替 <code class=\"language language-text\">/user/37153/orders</code> 以防你忘了检查权限，导致数据泄露。</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">修改邮箱/手机号码</code>功能必须首先确认用户已经验证过邮箱/手机是他自己的。</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 任何上传功能应该过滤用户上传的文件名，另外，为了普适性的原因（而不是安全问题），\n上传的东西应该存放到例如 S3 之类的云存储上面(用 lambda 处理)，而不是存储在自己的服务器，防止代码执行。</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">个人头像上传</code> 功能应该过滤所有的 <code class=\"language language-text\">EXIF</code> 标签，即便没有这个需求.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 用户 ID 或者其他的 ID，应该使用 <a href=\"http://www.ietf.org/rfc/rfc4122.txt\">RFC compliant</a>\n的 <code class=\"language language-text\">UUID</code> 而不是整数. 你可以从 github 找到你所用的语言的实现.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <a href=\"https://jwt.io/\">JWT（JSON Web Token）</a>很棒.当你需要构建一个 单页应用/API 时使用.</li>\n</ul>\n<h3 id=\"安卓和-ios-app\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E5%8D%93%E5%92%8C-ios-app\" aria-label=\"安卓和 ios app permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安卓和 iOS APP</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 支付网关的 <code class=\"language language-text\">盐（salt）</code> 不应该被硬编码</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 来自第三方的 <code class=\"language language-text\">secret</code> 和 <code class=\"language language-text\">auth token</code> 不应该被硬编码</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在服务器之间调用的 API 不应该在 app 里面调用</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在安卓系统下，要小心评估所有申请的 <a href=\"https://developer.android.com/guide/topics/security/permissions.html\">权限</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在 iOS 系统下，使用系统的钥匙串来存储敏感信息（权限 token、api key、 等等） <strong>不要</strong> 把这类信息存储在用户配置里面</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 强烈推荐<a href=\"https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning\">证书绑定（Certificate pinning）</a></li>\n</ul>\n<h3 id=\"安全头信息和配置\" style=\"position:relative;\"><a href=\"#%E5%AE%89%E5%85%A8%E5%A4%B4%E4%BF%A1%E6%81%AF%E5%92%8C%E9%85%8D%E7%BD%AE\" aria-label=\"安全头信息和配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>安全头信息和配置</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> <a href=\"https://en.wikipedia.org/wiki/Content_Security_Policy\">CSP</a> 头信息，\n减缓 XSS 和数据注入攻击. 这很重要.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> <a href=\"https://en.wikipedia.org/wiki/Cross-site_request_forgery\">CSRF</a> 头信息防止跨站请求伪造（CSRF）攻击.\n同时<code class=\"language language-text\">添加</code> <a href=\"https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00\">SameSite</a>\n属性到 cookie 里面.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> <a href=\"https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security\">HSTS</a>\n头信息防止 SSL stripping 攻击.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> 你的域名到 <a href=\"https://hstspreload.appspot.com/\">HSTS 预加载列表</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> <a href=\"https://en.wikipedia.org/wiki/Clickjacking#X-Frame-Options\">X-Frame-Options</a>\n防止点击劫持.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">添加</code> <a href=\"https://www.owasp.org/index.php/OWASP_Secure_Headers_Project#X-XSS-Protection\">X-XSS-Protection</a>\n缓解 XSS 攻击.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">更新</code> DNS 记录，增加 <a href=\"https://en.wikipedia.org/wiki/Sender_Policy_Framework\">SPF</a>\n记录防止垃圾邮件和钓鱼攻击.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 如果你的 Javascript 托管在第三方的 CDN 上面，\n需要<code class=\"language language-text\">添加</code> <a href=\"https://en.wikipedia.org/wiki/Subresource_Integrity\">内部资源集成检查</a> 。\n为了更加安全，添加<a href=\"https://w3c.github.io/webappsec-subresource-integrity/#parse-require-sri-for\">require-sri-for</a>\nCSP-directive 就不会加载到没有 SRI 的资源</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用随机的 CSRF token，业务逻辑 API 可以暴露为 POST 请求。\n不要把 CSRF token 通过 http 接口暴露出来，比如第一次请求更新的时候</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在 get 请求参数里面，不要使用临界数据和 token。 暴露服务器日志的同时也会暴露用户数据</li>\n</ul>\n<h3 id=\"过滤输入\" style=\"position:relative;\"><a href=\"#%E8%BF%87%E6%BB%A4%E8%BE%93%E5%85%A5\" aria-label=\"过滤输入 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>过滤输入</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 所有暴露给用户的参数输入都应该\n<code class=\"language language-text\">过滤</code> 防止 <a href=\"https://en.wikipedia.org/wiki/Cross-site_scripting\">XSS</a> 攻击.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用参数化的查询防止 <a href=\"https://en.wikipedia.org/wiki/SQL_injection\">SQL 注入</a>.</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 过滤所有具有功能性的用户输入，比如 <code class=\"language language-text\">CSV导入</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">过滤</code>一些特殊的用户输入，例如将 robots.txt 作为用户名，而你刚好提供了 coolcorp.io/username 之类的 url\n来提供用户信息访问页面。（此时变成 coolcorp.io/robots.txt，可能无法正常工作）</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 不要自己手动拼装 JSON 字符串，不管这个对象有多么小。请使用你所用的语言相应的库或者框架来编写</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> <code class=\"language language-text\">过滤</code> 那些有点像 URL 的输入，\n<a href=\"https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit#heading=h.t4tsk5ixehdd\">SSRF</a></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在输出显示给用户之前，<code class=\"language language-text\">过滤</code>输出信息</li>\n</ul>\n<h3 id=\"操作\" style=\"position:relative;\"><a href=\"#%E6%93%8D%E4%BD%9C\" aria-label=\"操作 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>操作</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 如果你的业务很小或者你缺乏经验，可以评估一下使用 AWS 或者一个 PaaS 平台来运行代码</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 在云上使用正规的脚本创建虚拟机</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 检查所有机器没有必要开放的<code class=\"language language-text\">端口</code></li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 检查数据库是否没有设置密码或者使用默认密码，特别是 MongoDB 和 Redis</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用 SSH 登录你的机器，不要使用密码，而是通过 SSH key 验证来登录</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 及时更新系统，防止出现 0day 漏洞，比如 Heartbleed、Shellshock 等</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 修改服务器配置，HTTPS 使用 TLS1.2，禁用其他的模式。(值得这么做)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 不要在线上开启 DEBUG 模式，有些框架，DEBUG 模式会开启很多权限以及后门，或者是暴露一些敏感数据到错误栈信息里面</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 对坏人和 DDOS 攻击要有所准备，使用那些提供 DDOS 清洗的主机服务</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 监控你的系统，同时记录到日志里面 (例如使用 <a href=\"https://newrelic.com/\">New Relic</a> 或者其他 ).</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 如果是 2B 的业务，坚持顺从需求。如果使用 AWS S3,可以考虑使用\n<a href=\"http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html\">数据加密</a>\n功能. 如果使用 AWS EC2，考虑使用磁盘加密功能（现在系统启动盘也能加密了）</li>\n</ul>\n<h3 id=\"关于人\" style=\"position:relative;\"><a href=\"#%E5%85%B3%E4%BA%8E%E4%BA%BA\" aria-label=\"关于人 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>关于人</h3>\n<ul class=\"contains-task-list\">\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 开一个邮件组（例如：<a href=\"mailto:security@coolcorp.io\">security@coolcorp.io</a>）和搜集页面，方便安全研究人员提交漏洞</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 取决于你的业务，限制用户数据库的访问</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 对报告 bug、漏洞的人有礼貌</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 把你的代码给那些有安全编码观念的同伴进行 review (More eyes)</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 被黑或者数据泄露时，检查数据访问前的日志，通知用户更改密码。你可能需要外部的机构来帮助审计</li>\n<li class=\"task-list-item\"><input type=\"checkbox\" disabled> 使用 <a href=\"https://github.com/Netflix/Scumblr\">Netflix Scumblr</a> 及时了解\n你的组织（公司）在社交网络或者搜索引擎上的一些讨论信息，比如黑客攻击、漏洞等等</li>\n</ul>","prevPost":{"slug":"/vimBasicNotes/","title":"Vim Basic Notes"},"nextPost":{"slug":"/reactjsBasicNotes/","title":"React Basic Notes"}}}},"staticQueryHashes":["1635110865","1796865374","824522976"]}